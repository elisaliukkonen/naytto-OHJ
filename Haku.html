<!DOCTYPE html>
<html lang="fi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mikkelin tapahtumat</title>
  <link rel="stylesheet" href="tyyli.css">
</head>
<body>

<header>
  <h1>Mikkelin tapahtumat</h1>
  <div class="header-controls">
    <input type="text" id="searchInput" class="search-input" placeholder="Hae tapahtumaa...">

    <div class="dropdown">
      <button onclick="toggleDropdown()" class="dropbtn">Suodata päivämäärällä</button>
      <div id="dateDropdown" class="dropdown-content">

        <div class="filter-row">
          <button class="btn active" onclick="Suodatavalitut('all')">Näytä kaikki</button>
        </div>

        <div class="filter-row">
          <button class="btn" onclick="showDateFilter('paiva')">Päivä</button>
          <input id="paivaInput" type="date" class="date-picker">
          <button class="btn-aika" id="aikaPaivaBtn" onclick="Aikavalinta('paiva')">Aika välillä</button>
          <input id="aikaPaivaAl" type="time" class="time-picker">
          <input id="aikaPaivaLo" type="time" class="time-picker">
        </div>

        <div class="filter-row">
          <button class="btn" onclick="showDateFilter('viikko')">Viikko</button>
          <input id="viikkoInput" type="week" class="date-picker">
          <button class="btn-aika" id="aikaViikkoBtn" onclick="Aikavalinta('viikko')">Aika välillä</button>
          <input id="aikaViikkoAl" type="time" class="time-picker">
          <input id="aikaViikkoLo" type="time" class="time-picker">
        </div>

        <div class="filter-row">
          <button class="btn" onclick="showDateFilter('kuukausi')">Kuukausi</button>
          <input id="kuukausiInput" type="month" class="date-picker">
          <button class="btn-aika" id="aikaKuukausiBtn" onclick="Aikavalinta('kuukausi')">Aika välillä</button>
          <input id="aikaKuukausiAl" type="time" class="time-picker">
          <input id="aikaKuukausiLo" type="time" class="time-picker">
        </div>

      </div>
    </div>
  </div>
</header>


<script>
  let selectedDate = null;
  let selectedWeek = null;
  let selectedMonth = null;
  let startTime = null;
  let endTime = null;

  function toggleDropdown() {
    document.getElementById('dateDropdown').classList.toggle('show');
  }

  function Suodatavalitut() {
    selectedDate = null;
    selectedWeek = null;
    selectedMonth = null;
    startTime = null;
    endTime = null;

    document.querySelectorAll('.date-picker').forEach(el => {
      el.style.display = 'none';
      el.value = '';
    });

    document.querySelectorAll('.btn-aika').forEach(el => el.style.display = 'none');
    document.querySelectorAll('.time-picker').forEach(el => {
      el.style.display = 'none';
      el.value = '';
    });

    document.querySelectorAll('#dateDropdown .btn').forEach(b => b.classList.remove('active'));
    event.target.classList.add('active');
  }

  function showDateFilter(type) {
    document.querySelectorAll('.date-picker').forEach(el => el.style.display = 'none');
    document.querySelectorAll('.btn-aika').forEach(el => el.style.display = 'none');
    document.querySelectorAll('.time-picker').forEach(el => {
      el.style.display = 'none';
      el.value = '';
    });
//Päivä valinta
    if (type === 'paiva') {
      const input = document.getElementById('paivaInput');
      input.style.display = 'inline-block';
      document.getElementById('aikaPaivaBtn').style.display = 'inline-block';

      input.onchange = function () {
        if (this.value) {
          const [year, month, day] = this.value.split('-');
          selectedDate = `${parseInt(day)}.${parseInt(month)}.${year}`;
        } else {
          selectedDate = null;
        }
      };
    }
//Viikko valinta
    if (type === 'viikko') {
      const input = document.getElementById('viikkoInput');
      input.style.display = 'inline-block';
      document.getElementById('aikaViikkoBtn').style.display = 'inline-block';

      input.onchange = function () {
        selectedWeek = this.value;
      };
    }
//Kuukausi valinta
    if (type === 'kuukausi') {
      const input = document.getElementById('kuukausiInput');
      input.style.display = 'inline-block';
      document.getElementById('aikaKuukausiBtn').style.display = 'inline-block';

      input.onchange = function () {
        if (this.value) {
          const [year, month] = this.value.split('-');
          selectedMonth = `${parseInt(month)}.${year}`;
        } else {
          selectedMonth = null;
        }
      };
    }
  }
//Aika väli valinta
  function Aikavalinta(type) {
    const startInput = document.getElementById(`aika${type.charAt(0).toUpperCase() + type.slice(1)}Al`);
    const endInput = document.getElementById(`aika${type.charAt(0).toUpperCase() + type.slice(1)}Lo`);

    const show = startInput.style.display !== 'inline-block';
    document.querySelectorAll('.time-picker').forEach(t => t.style.display = 'none');
    startInput.style.display = show ? 'inline-block' : 'none';
    endInput.style.display = show ? 'inline-block' : 'none';

    if (!show) {
      startInput.value = '';
      endInput.value = '';
      startTime = null;
      endTime = null;
      return;
    }

    startInput.onchange = function () {
      startTime = this.value;
    };

    endInput.onchange = function () {
      endTime = this.value;
    };
  }

  window.onclick = function (event) {
    if (!event.target.matches('.dropbtn') && !event.target.closest('#dateDropdown')) {
      document.getElementById('dateDropdown').classList.remove('show');
    }
  };
</script>

</body>
</html>

